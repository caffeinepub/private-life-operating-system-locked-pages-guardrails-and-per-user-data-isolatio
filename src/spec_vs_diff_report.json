{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-14T09:37:30.022Z",
  "summary": "Diff implements a unified TanStack Router tree with guest (/login) and authenticated routes, adds Focus Mode UI plumbing for “Mark Done”, and adds Weekly Reset UI flow that saves a weekly review then calls a reset mutation. Backend shows a state schema change (adds dailyTasks with migration scaffolding), but the diff summary does not provide explicit evidence of the backend methods required to persist task completion or to clear tasks for weekly reset with ownership enforcement.",
  "missing_requirements": [
    {
      "id": "REQ-21",
      "requirement": "Persist task completion from Focus Mode in backend state (Task.status -> completed) with backend-enforced ownership, and ensure Dashboard no longer shows the task after exiting Focus Mode.",
      "reason": "Frontend now calls a mark-done mutation (FocusMode -> onMarkDone; Dashboard -> useMarkTaskDone), but the backend diff excerpt does not show any shared method that updates Task.status to #completed nor any ownership check for that operation. Without an explicit backend function in backend/main.mo, the AC about persistent state and backend-enforced ownership is not evidenced.",
      "evidence": [
        "frontend/src/components/FocusMode.tsx",
        "frontend/src/pages/DashboardPage.tsx",
        "frontend/src/hooks/useQueries.ts (summary mentions useMarkTaskDone but truncated content not shown)",
        "backend/main.mo (truncated; no mark-done method shown)"
      ]
    },
    {
      "id": "REQ-22",
      "requirement": "Weekly Reset must persist the weekly review and then clear the authenticated user’s current tasks for the new week, with backend-enforced ownership (cannot affect other users).",
      "reason": "Frontend WeeklyResetPage calls useResetWeeklyTasks after saving the review, but the backend diff excerpt does not show a reset/clear-tasks method or the ownership enforcement logic. The backend schema adds dailyTasks, but no clearing behavior is evidenced in the shown backend/main.mo excerpt.",
      "evidence": [
        "frontend/src/pages/WeeklyResetPage.tsx",
        "frontend/src/hooks/useQueries.ts (summary mentions useResetWeeklyTasks but truncated content not shown)",
        "backend/main.mo (truncated; no reset method shown)",
        "backend/migration.mo"
      ]
    }
  ],
  "hallucinated_features": [],
  "confidence": 0.62,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/FocusMode.tsx",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/pages/ClarifyPage.tsx",
    "frontend/src/pages/DashboardPage.tsx",
    "frontend/src/pages/LoginPage.tsx",
    "frontend/src/pages/WeeklyResetPage.tsx",
    "project_state.json"
  ]
}